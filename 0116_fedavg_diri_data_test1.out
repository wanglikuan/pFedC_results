
Number of users: 20
Number of classes: 10
Min # of samples per uesr: 10
Alpha for Dirichlet Distribution: 0.1
Ratio for Sampling Training Data: 0.5
Reading source dataset.
Loading data from storage ...
Rearrange data by class...
TRAIN SET:
  Total #samples: 60000. sample shape: torch.Size([1, 28, 28])
  #samples per class:
 [5923, 6742, 5958, 6131, 5842, 5421, 5918, 6265, 5851, 5949]
Loading data from storage ...
Rearrange data by class...
TEST SET:
  Total #samples: 10000. sample shape: torch.Size([1, 28, 28])
  #samples per class:
 [980, 1135, 1032, 1010, 982, 892, 958, 1028, 974, 1009]
10 labels in total.
Try to find valid data separation
7 6265 1500
3 6131 1500
2 5958 1500
8 5851 1500
5 5421 1500
6 5918 1500
9 5949 1500
4 5842 1500
0 5923 1500
1 6742 1500
processing users...
TRAIN #sample by user: [215, 1122, 340, 673, 706, 248, 121, 425, 1036, 1524, 532, 1202, 144, 1161, 758, 202, 1825, 596, 672, 1498]
Dumping train data => ./ou20c10-alpha0.1-ratio0.5/train/train.pt
215 samples in total
c=1,n=5| c=2,n=5| c=6,n=1| c=8,n=7| c=9,n=197| 
5 Labels/ 215 Number of training samples for user [0]:
1122 samples in total
c=0,n=944| c=3,n=11| c=6,n=3| c=7,n=164| 
4 Labels/ 1122 Number of training samples for user [1]:
340 samples in total
c=0,n=114| c=2,n=146| c=3,n=4| c=4,n=12| c=6,n=5| c=9,n=59| 
6 Labels/ 340 Number of training samples for user [2]:
673 samples in total
c=0,n=4| c=1,n=1| c=3,n=4| c=4,n=1| c=5,n=39| c=6,n=28| c=7,n=510| c=9,n=86| 
8 Labels/ 673 Number of training samples for user [3]:
706 samples in total
c=2,n=690| c=6,n=16| 
2 Labels/ 706 Number of training samples for user [4]:
248 samples in total
c=0,n=146| c=1,n=3| c=2,n=42| c=3,n=31| c=6,n=11| c=7,n=10| c=8,n=4| c=9,n=1| 
8 Labels/ 248 Number of training samples for user [5]:
121 samples in total
c=1,n=2| c=4,n=42| c=5,n=77| 
3 Labels/ 121 Number of training samples for user [6]:
425 samples in total
c=0,n=6| c=2,n=16| c=3,n=52| c=4,n=266| c=7,n=85| 
5 Labels/ 425 Number of training samples for user [7]:
1036 samples in total
c=0,n=3| c=1,n=731| c=5,n=292| c=6,n=1| c=9,n=9| 
5 Labels/ 1036 Number of training samples for user [8]:
1524 samples in total
c=2,n=1| c=3,n=642| c=4,n=734| c=5,n=82| c=8,n=65| 
5 Labels/ 1524 Number of training samples for user [9]:
532 samples in total
c=0,n=53| c=1,n=68| c=2,n=339| c=5,n=24| c=7,n=44| c=8,n=4| 
6 Labels/ 532 Number of training samples for user [10]:
1202 samples in total
c=2,n=88| c=6,n=347| c=7,n=517| c=8,n=191| c=9,n=59| 
5 Labels/ 1202 Number of training samples for user [11]:
144 samples in total
c=1,n=92| c=2,n=1| c=4,n=8| c=5,n=3| c=7,n=24| c=8,n=16| 
6 Labels/ 144 Number of training samples for user [12]:
1161 samples in total
c=0,n=1| c=1,n=1| c=7,n=15| c=8,n=1119| c=9,n=25| 
5 Labels/ 1161 Number of training samples for user [13]:
758 samples in total
c=1,n=74| c=2,n=160| c=3,n=486| c=6,n=1| c=8,n=14| c=9,n=23| 
6 Labels/ 758 Number of training samples for user [14]:
202 samples in total
c=0,n=192| c=7,n=1| c=8,n=9| 
3 Labels/ 202 Number of training samples for user [15]:
1825 samples in total
c=3,n=1| c=5,n=86| c=6,n=723| c=9,n=1015| 
4 Labels/ 1825 Number of training samples for user [16]:
596 samples in total
c=0,n=15| c=1,n=1| c=2,n=7| c=3,n=92| c=6,n=347| c=7,n=129| c=9,n=5| 
7 Labels/ 596 Number of training samples for user [17]:
672 samples in total
c=0,n=22| c=3,n=177| c=4,n=436| c=5,n=1| c=6,n=16| c=9,n=20| 
6 Labels/ 672 Number of training samples for user [18]:
1498 samples in total
c=1,n=522| c=2,n=5| c=4,n=1| c=5,n=896| c=6,n=1| c=7,n=1| c=8,n=71| c=9,n=1| 
8 Labels/ 1498 Number of training samples for user [19]:
TEST #sample by user: [252, 197, 296, 396, 98, 402, 149, 250, 246, 242, 299, 247, 299, 254, 302, 148, 191, 354, 289, 396]
Dumping train data => ./ou20c10-alpha0.1-ratio0.5/test/test.pt
Finish Generating User samples
